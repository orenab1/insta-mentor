<div *ngIf="model" class="form-group mt-5">
  <div class="row justify-content-center">
    <div class="col-xl-7 col-lg-7 col-md-10 col-sm-12 mt-3 mb-5">
      <div class="card p-3">
        <div class="aligns-items-center">
          <i
            class="fa fa-pencil"
            style="float: right; margin-right: 18px; cursor: pointer;"
            [routerLink]="['/edit-question', model.id]"
          ></i>

          <p class="faded-text" style="font-size: 11px;">
            {{ model.created | date: 'short' }}
          </p>

          <div class="mb-4">
            <app-display-user-summary
              [username]="model.askerUsername"
            ></app-display-user-summary>
          </div>
          <div class="d-flex" style="flex-wrap: wrap;">
            <div
              *ngFor="let tag of model.tags"
              class="tag-display bottom-tag"
              style="padding: 0px 8px; font-size: 15px; margin-right: 7px;"
            >
              {{ tag.display }}
            </div>
          </div>

          <div class="my-2" style="opacity: 0.7;">
            Community:&nbsp;{{ communitiesAsString }}

            <div>
              Author thinks this should take
              {{ lengthAsString }}
            </div>
          </div>

          <hr />
          <!-- <button
            *ngIf="this.isCurrentUserQuestionOwner"
            class="btn btn-secondary"
            (click)="edit()"
          >
            Edit
          </button>
          <button
            *ngIf="this.isCurrentUserQuestionOwner"
            class="btn btn-secondary"
            (click)="toggleSolved()"
          >
            Sovled
          </button>
          is solved? {{ this.model.isSolved }} -->
          <h3>{{ model.header }}</h3>

          <div class="mt-4"></div>

          <div>
            <p>{{ model.body }}</p>
            <div class="d-flex flex-row my-5">
              <img *ngIf="model.photoUrl" img src="{{ model.photoUrl }}" />
            </div>

            <div
              class="text-center my-5"
              *ngIf="
                this.isCurrentUserQuestionOwner && model.lastAnswererUserId > 0;
                else notSolved
              "
            >
              <button
                class="btn btn-primary"
                style="width: 250px;"
                (click)="solved(hasAnswererHelped)"
              >
                {{ true ? 'Solved' : '' }}
              </button>
            </div>

            <ng-template
              class="text-center my-5"
              #notSolved
              *ngIf="!this.isCurrentUserQuestionOwner"
            >
              <button
                (click)="addOffer()"
                class="btn btn-primary"
                style="width: 250px;"
              >
                {{ true ? 'I CAN HELP!' : 'Solved' }}
              </button>
            </ng-template>
          </div>
        </div>
      </div>
      <ul class="nav nav-tabs mt-3">
        <li class="nav-item" style="margin-right: 10px;">
          <a
            class="nav-link"
            aria-current="page"
            (click)="toggleDisplayComments()"
            [ngClass]="{ active: !shouldDisplayComments }"
          >
            Comments

            <img
              style="width: 14px; margin-top: -1px; margin-left: 7px;"
              src="./assets/comments.png"
            />
          </a>
        </li>
        <li class="nav-item">
          <a
            class="nav-link"
            tabindex="-1"
            (click)="toggleDisplayComments()"
            [ngClass]="{ active: shouldDisplayComments }"
          >
            Helpers

            <img
              style="width: 14px; margin-top: -1px; margin-left: 7px;"
              src="./assets/support.png"
            />
          </a>
        </li>
      </ul>

      <div class="card p-3 mt-4">
        <div [hidden]="shouldDisplayComments" class="nav-content-container">
          <div class="semi-bold-font nav-content">Comments</div>
          <app-comments
            [comments]="model.comments"
            [questionId]="model.id"
            [askerId]="model.askerId"
          ></app-comments>
        </div>

        <div [hidden]="!shouldDisplayComments" class="nav-content-container">
          <div class="semi-bold-font nav-content">Helpers</div>
          <app-offers [offers]="model.offers"></app-offers>
        </div>
      </div>
    </div>
  </div>
  <ng-template #hasAnswererHelped>
    <div style="margin: 20px;">
      <h5 style="margin-bottom: 17px;">
        Has {{ model.lastAnswererUserName }} helped you solve your question?
      </h5>
      <button
        type="button"
        class="btn btn-primary"
        style="width: 70px; margin-right: 20px;"
        (click)="answererHelped(reviewModal)"
      >
        Yes
      </button>
      <button
        type="button"
        class="btn btn-primary"
        style="background-color: white !important; color: red; border: none;"
        (click)="answererDidntHelp()"
      >
        No
      </button>

      <div></div>
    </div>
  </ng-template>

  <ng-template #reviewModal>
    <div style="margin: 20px;">
      <h5 style="margin-bottom: 17px;">
        Please tell us what you think..
      </h5>
      <app-display-user-summary
        [userId]="model.lastAnswererUserId"
      ></app-display-user-summary>

      <div class="mt-4 mb-2">
        <label>How helpful was {{ model.lastAnswererUserName }}?</label>
      </div>
      <div>
        <rating-basic></rating-basic>
      </div>
      <div class="mt-4">
        <div class="form-group">
          <div><label for="review">Review</label></div>
          <textarea
            [(ngModel)]="review"
            rows="3"
            style="resize: none; width: 100%;"
          ></textarea>
        </div>
      </div>
      <button
        class="btn btn-primary semi-bold-font"
        style="width: 100%; margin-top: 35px;"
      >
        SUBMIT
      </button>
      <button class="btn semi-bold-font" style="width: 100%; color: #624000;">
        SKIP
      </button>
    </div>
  </ng-template>

  <app-review [questionId]="id"></app-review>
</div>
